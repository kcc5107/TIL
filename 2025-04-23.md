# TIL - 자바에서 split() 사용 시 정규표현식과 이스케이프 처리

계산기 과제가 끝나고 자유롭게 수정해보는 과정에서 `31+5`처럼 연산식을 전체로 입력했을 때,  
문자열로 입력받아서 이를 연산기호 기준으로 나누기 위해 `String.split()` 메서드를 사용하고 있었다.  
하지만 의도대로 동작하지 않았기때문에 무언가 실수했다고 생각했지만 코드에서 문제점을 찾지못했고  
결국 `+`와 `*`는 오작동을 일으키나 `-`와 `/`는 정상 작동하는 것을 알아냈다.

---

## 문제 원인
중간 과정을 콘솔로 출력하면서 알아낸 결과, 연산기호 자체는 제대로 찾아냈으나 `+`나 `*` 연산자는 `split()`으로 제대로 나눠지지 않는 문제가 발생했다.  
이에 알아본 결과 `split(String regex)` 메서드는 **정규표현식 기반**이다.  
즉, 전달된 문자열을 단순한 문자로 보지 않고 **정규표현식으로 해석**한다.

### 정규표현식에서 특별한 의미를 가지는 기호들
| 기호 | 정규식 의미                 |
|------|-----------------------------|
| `+`  | 1개 이상                    |
| `*`  | 0개 이상                    |
| `.`  | 모든 문자                   |
| `|`  | OR 연산                     |
| `(`, `)`, `[`, `]`, `{`, `}` | 그룹, 집합 등 |

```java
"10+5".split("+") // ❌ 잘못된 결과 또는 예외 발생
```

---

## 해결 방법 1: 수동 이스케이프 처리
정규표현식 특수문자를 문자열로 인식시키려면 이스케이프 문자 `\` 가 필요하다.  
`Java`에서는 `\` 자체도 이스케이프해야 하므로 `\\`를 사용해야 한다.
```java
expression.split("\\+"); // + 기호 기준 split
```
하지만 이 방법은 연산 기호가 무엇이냐에 따라 달라지기 때문에 조건문을 넣는 등 코드가 복잡해진다.

---

## 해결 방법 2: Pattern.quote() 사용
`Pattern.quote()`는 주어진 문자열을 정규표현식에서 문자 그대로 쓰이도록 자동 이스케이프 처리한다.
```java
import java.util.regex.Pattern;

String[] operand = expression.split(Pattern.quote(Character.toString(oper)));
```
### 장점
- 연산자가 어떤 문자이든 안전하게 처리 (예: `+, *, ., /` 등)
- 조건문 없이 깔끔하게 처리 가능
- 유지보수성 우수

### Pattern.quote()를 쓰면 좋을때
- `split()`할 구분자가 사용자 입력값일 경우
- `., +, *` 같은 특수 기호가 포함될 가능성이 있을 경우
- 정규식을 직접 다루지 않고 문자 그대로 분리하고 싶을 때