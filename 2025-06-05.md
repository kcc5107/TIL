# TIL: DB FK를 생략하고 JPA로만 연관관계 설정하는 이유

## 1. 유연한 배포와 마이그레이션

DB FK가 있으면 테이블 순서나 데이터 제약으로 인해 배포 시 제약 조건 오류가 날 수 있다.  
**대규모 서비스**에서는 점진적인 마이그레이션(점진적 변경/릴리즈)을 위해 FK 없이 처리하는 것이 더 유리할 수 있음.

## 2. 퍼포먼스 이슈 방지

외래 키가 있으면 삽입/삭제 시 **참조 무결성 체크**가 발생 → DB 부하 증가  
특히 대량의 데이터나 트래픽이 있는 서비스에서는 FK로 인한 성능 저하를 피하기 위해 생략한다.

## 3. JPA가 연관관계 관리를 하기 때문에 DB FK 없이도 로직상 연관관계를 처리 가능하다.

예: `@ManyToOne, @OneToMany` 등의 어노테이션만으로도 JPA는 연관된 엔티티를 가져올 수 있다.  
애플리케이션 레벨에서 관계를 명확히 정의했기 때문에 JPA만으로도 데이터 일관성을 어느 정도 유지가 가능하다.

## 4. 테스트와 유닛 단위 개발이 쉽다.

DB 제약 없이 가벼운 테스트 데이터 세팅이 가능해진다.  
mocking이나 in-memory DB로 테스트할 때 FK가 없으면 에러를 덜 만난다.

---

## 단점: FK를 DB에 안 두었을 때의 리스크

1. 진짜 무결성 보장이 안됨
   * 실수로 잘못된 참조 ID를 저장해도 DB는 오류를 내지 않음 → 데이터 오염 가능.  
   * 결국 **"애플리케이션이 모든 무결성을 책임진다"** 는 뜻인데, 이는 쉬운 일이 아니다.
2. DB 툴이나 쿼리에서 자동 join 추론이 어렵다.  
   * ERD 툴, SQL 자동화 툴 등은 FK 기준으로 관계를 파악함. 없으면 자동화가 떨어짐.
3. 삭제 등급 cascade가 DB 차원에서 불가능  
   * `ON DELETE CASCADE` 같은 DB 기능을 활용하지 못한다.